{"ast":null,"code":"export default class Card {\n  constructor(cardTemplate, name, link, cardId, likes, handleImageClick, confirmPopup, owner, user) {\n    this.handleClick = api => {\n      if (this._owner._id === this._user.id) {\n        return api.deleteCard(this._cardId).then(() => {\n          this._confirmPopup.close();\n\n          this._deleteCard();\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    };\n\n    this._setEventListeners = api => {\n      this._likeButton = this._element.querySelector(\".card__like-button\");\n\n      this._likeButton.addEventListener(\"click\", () => {\n        if (!this._likeButton.classList.contains(\"info__card_like-button_state_active\")) {\n          this._likeJustClicked = true;\n        }\n\n        this._checkLikes(api);\n      });\n\n      this._cardDelete.addEventListener(\"click\", () => {\n        this._confirmPopup.open(this.handleClick, api);\n      });\n\n      this._cardImage.addEventListener(\"click\", () => {\n        this._handleImageClick({\n          url: this._link,\n          caption: this._name\n        });\n      });\n    };\n\n    this._cardTemplate = cardTemplate;\n    this._name = name;\n    this._link = link;\n    this._cardId = cardId;\n    this._likes = likes;\n    this._handleImageClick = handleImageClick;\n    this._confirmPopup = confirmPopup;\n    this._owner = owner;\n    this._user = user;\n  } // * * this function generates the card \n\n\n  generateCard(api) {\n    this._createCard();\n\n    this._setEventListeners(api);\n\n    this._toggleLikes();\n\n    return this._element;\n  } // * * this function sets all the info of the card\n\n\n  _createCard() {\n    this._element = this._getTemplate();\n    const card = this._element;\n    this._cardImage = card.querySelector(\".card__image\");\n    card.querySelector(\".card__text\").textContent = this._name;\n    this._cardImage.src = this._link;\n    this._cardImage.alt = `A view of ${this._name}`;\n    this._likeNumber = this._element.querySelector(\".card__like-number\");\n    this._likeNumber.textContent = this.getLikeNumber();\n    return card;\n  }\n\n  _setCardLikes() {\n    this._likeNumber.textContent = this.getLikeNumber();\n  } // * * this function creates the card template\n\n\n  _getTemplate() {\n    const cardElement = document.querySelector(this._cardTemplate).content.querySelector(\".card\").cloneNode(true);\n    this._cardDelete = cardElement.querySelector(\".card__delete\");\n\n    if (this._owner) {\n      if (!(this._owner._id === this._user.id)) {\n        this._cardDelete.classList.add(\"card__delete_hidden\");\n      }\n    }\n\n    return cardElement;\n  }\n\n  getLikeNumber() {\n    if (this._likes) {\n      return this._likes.length;\n    }\n\n    return 0;\n  }\n\n  _isLiked() {\n    for (let i = 0; i < this._likes.length; i++) {\n      if (this._likes[i]._id === this._user.id) {\n        return true;\n      }\n\n      return false;\n    }\n  } // * * this function toggles likes for the cards\n\n\n  _checkLikes(api) {\n    if (this._likeJustClicked) {\n      if (this._likes) {\n        this._likes[this._likes.length] = this._user;\n      }\n\n      api.addLike(this._cardId).then(() => {\n        this._likeNumber.textContent = this.getLikeNumber();\n\n        this._likeButton.classList.add(\"info__card_like-button_state_active\");\n\n        this._justClicked = false;\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      api.removeLike(this._cardId).then(data => {\n        this._likes = data.likes;\n        this._likeNumber.textContent = this.getLikeNumber();\n\n        this._likeButton.classList.remove(\"info__card_like-button_state_active\");\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n\n    this._setCardLikes();\n  }\n\n  _toggleLikes() {\n    if (this._likes) {\n      for (let i = 0; i < this._likes.length; i++) {\n        if (this._likes[i]._id === this._user.id) {\n          this._likeButton.classList.add(\"info__card_like-button_state_active\");\n        }\n      }\n    }\n  } // * * this function deletes the card\n\n\n  _deleteCard() {\n    this._element.remove();\n  }\n\n}\n;","map":{"version":3,"sources":["C:/Users/minka/OneDrive/Desktop/dev/around-react/project_10/src/components/Card.js"],"names":["Card","constructor","cardTemplate","name","link","cardId","likes","handleImageClick","confirmPopup","owner","user","handleClick","api","_owner","_id","_user","id","deleteCard","_cardId","then","_confirmPopup","close","_deleteCard","catch","err","console","log","_setEventListeners","_likeButton","_element","querySelector","addEventListener","classList","contains","_likeJustClicked","_checkLikes","_cardDelete","open","_cardImage","_handleImageClick","url","_link","caption","_name","_cardTemplate","_likes","generateCard","_createCard","_toggleLikes","_getTemplate","card","textContent","src","alt","_likeNumber","getLikeNumber","_setCardLikes","cardElement","document","content","cloneNode","add","length","_isLiked","i","addLike","_justClicked","removeLike","data","remove"],"mappings":"AAAA,eAAe,MAAMA,IAAN,CAAW;AACtBC,EAAAA,WAAW,CAACC,YAAD,EAAeC,IAAf,EAAqBC,IAArB,EAA2BC,MAA3B,EAAmCC,KAAnC,EAA0CC,gBAA1C,EAA4DC,YAA5D,EAA0EC,KAA1E,EAAiFC,IAAjF,EAAuF;AAAA,SA4DlGC,WA5DkG,GA4DnFC,GAAD,IAAS;AACnB,UAAI,KAAKC,MAAL,CAAYC,GAAZ,KAAoB,KAAKC,KAAL,CAAWC,EAAnC,EAAuC;AACnC,eAAOJ,GAAG,CAACK,UAAJ,CAAe,KAAKC,OAApB,EACFC,IADE,CACG,MAAM;AACR,eAAKC,aAAL,CAAmBC,KAAnB;;AACA,eAAKC,WAAL;AACH,SAJE,EAIAC,KAJA,CAIOC,GAAD,IAAS;AACdC,UAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,SANE,CAAP;AAOH;AACJ,KAtEiG;;AAAA,SAyElGG,kBAzEkG,GAyE5Ef,GAAD,IAAS;AAC1B,WAAKgB,WAAL,GAAmB,KAAKC,QAAL,CAAcC,aAAd,CAA4B,oBAA5B,CAAnB;;AACA,WAAKF,WAAL,CAAiBG,gBAAjB,CAAkC,OAAlC,EAA2C,MAAM;AAC7C,YAAI,CAAC,KAAKH,WAAL,CAAiBI,SAAjB,CAA2BC,QAA3B,CAAoC,qCAApC,CAAL,EAAiF;AAC7E,eAAKC,gBAAL,GAAwB,IAAxB;AACH;;AACD,aAAKC,WAAL,CAAiBvB,GAAjB;AACH,OALD;;AAQA,WAAKwB,WAAL,CAAiBL,gBAAjB,CAAkC,OAAlC,EAA2C,MAAM;AAC7C,aAAKX,aAAL,CAAmBiB,IAAnB,CAAwB,KAAK1B,WAA7B,EAA0CC,GAA1C;AACH,OAFD;;AAIA,WAAK0B,UAAL,CAAgBP,gBAAhB,CAAiC,OAAjC,EAA0C,MAAM;AAC5C,aAAKQ,iBAAL,CAAuB;AAAEC,UAAAA,GAAG,EAAE,KAAKC,KAAZ;AAAmBC,UAAAA,OAAO,EAAE,KAAKC;AAAjC,SAAvB;AACH,OAFD;AAGH,KA1FiG;;AAC9F,SAAKC,aAAL,GAAqB1C,YAArB;AACA,SAAKyC,KAAL,GAAaxC,IAAb;AACA,SAAKsC,KAAL,GAAarC,IAAb;AACA,SAAKc,OAAL,GAAeb,MAAf;AACA,SAAKwC,MAAL,GAAcvC,KAAd;AACA,SAAKiC,iBAAL,GAAyBhC,gBAAzB;AACA,SAAKa,aAAL,GAAqBZ,YAArB;AACA,SAAKK,MAAL,GAAcJ,KAAd;AACA,SAAKM,KAAL,GAAaL,IAAb;AACH,GAXqB,CAatB;;;AACAoC,EAAAA,YAAY,CAAClC,GAAD,EAAM;AACd,SAAKmC,WAAL;;AACA,SAAKpB,kBAAL,CAAwBf,GAAxB;;AACA,SAAKoC,YAAL;;AACA,WAAO,KAAKnB,QAAZ;AACH,GAnBqB,CAqBtB;;;AACAkB,EAAAA,WAAW,GAAG;AACV,SAAKlB,QAAL,GAAgB,KAAKoB,YAAL,EAAhB;AACA,UAAMC,IAAI,GAAG,KAAKrB,QAAlB;AACA,SAAKS,UAAL,GAAkBY,IAAI,CAACpB,aAAL,CAAmB,cAAnB,CAAlB;AACAoB,IAAAA,IAAI,CAACpB,aAAL,CAAmB,aAAnB,EAAkCqB,WAAlC,GAAgD,KAAKR,KAArD;AACA,SAAKL,UAAL,CAAgBc,GAAhB,GAAsB,KAAKX,KAA3B;AACA,SAAKH,UAAL,CAAgBe,GAAhB,GAAuB,aAAa,KAAKV,KAAO,EAAhD;AACA,SAAKW,WAAL,GAAmB,KAAKzB,QAAL,CAAcC,aAAd,CAA4B,oBAA5B,CAAnB;AACA,SAAKwB,WAAL,CAAiBH,WAAjB,GAA+B,KAAKI,aAAL,EAA/B;AACA,WAAOL,IAAP;AACH;;AAEDM,EAAAA,aAAa,GAAG;AACZ,SAAKF,WAAL,CAAiBH,WAAjB,GAA+B,KAAKI,aAAL,EAA/B;AACH,GApCqB,CAsCtB;;;AACAN,EAAAA,YAAY,GAAG;AACX,UAAMQ,WAAW,GAAGC,QAAQ,CACvB5B,aADe,CACD,KAAKc,aADJ,EAEfe,OAFe,CAGf7B,aAHe,CAGD,OAHC,EAIf8B,SAJe,CAIL,IAJK,CAApB;AAKA,SAAKxB,WAAL,GAAmBqB,WAAW,CAAC3B,aAAZ,CAA0B,eAA1B,CAAnB;;AACA,QAAI,KAAKjB,MAAT,EAAiB;AACb,UAAI,EAAE,KAAKA,MAAL,CAAYC,GAAZ,KAAoB,KAAKC,KAAL,CAAWC,EAAjC,CAAJ,EAA0C;AACtC,aAAKoB,WAAL,CAAiBJ,SAAjB,CAA2B6B,GAA3B,CAA+B,qBAA/B;AACH;AACJ;;AACD,WAAOJ,WAAP;AACH;;AAEDF,EAAAA,aAAa,GAAG;AACZ,QAAI,KAAKV,MAAT,EAAiB;AACb,aAAO,KAAKA,MAAL,CAAYiB,MAAnB;AACH;;AACD,WAAO,CAAP;AACH;;AAkCDC,EAAAA,QAAQ,GAAG;AACP,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnB,MAAL,CAAYiB,MAAhC,EAAwCE,CAAC,EAAzC,EAA6C;AACzC,UAAI,KAAKnB,MAAL,CAAYmB,CAAZ,EAAelD,GAAf,KAAuB,KAAKC,KAAL,CAAWC,EAAtC,EAA0C;AACtC,eAAO,IAAP;AACH;;AACD,aAAO,KAAP;AACH;AACJ,GApGqB,CAsGtB;;;AACAmB,EAAAA,WAAW,CAACvB,GAAD,EAAM;AACb,QAAI,KAAKsB,gBAAT,EAA2B;AACvB,UAAI,KAAKW,MAAT,EAAiB;AACb,aAAKA,MAAL,CAAY,KAAKA,MAAL,CAAYiB,MAAxB,IAAkC,KAAK/C,KAAvC;AACH;;AACDH,MAAAA,GAAG,CAACqD,OAAJ,CAAY,KAAK/C,OAAjB,EACKC,IADL,CACU,MAAM;AACR,aAAKmC,WAAL,CAAiBH,WAAjB,GAA+B,KAAKI,aAAL,EAA/B;;AACA,aAAK3B,WAAL,CAAiBI,SAAjB,CAA2B6B,GAA3B,CAA+B,qCAA/B;;AACA,aAAKK,YAAL,GAAoB,KAApB;AACH,OALL,EAKO3C,KALP,CAKcC,GAAD,IAAS;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,OAPL;AAQH,KAZD,MAYO;AACHZ,MAAAA,GAAG,CAACuD,UAAJ,CAAe,KAAKjD,OAApB,EACKC,IADL,CACWiD,IAAD,IAAU;AACZ,aAAKvB,MAAL,GAAcuB,IAAI,CAAC9D,KAAnB;AACA,aAAKgD,WAAL,CAAiBH,WAAjB,GAA+B,KAAKI,aAAL,EAA/B;;AACA,aAAK3B,WAAL,CAAiBI,SAAjB,CAA2BqC,MAA3B,CAAkC,qCAAlC;AACH,OALL,EAKO9C,KALP,CAKcC,GAAD,IAAS;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,OAPL;AASH;;AACD,SAAKgC,aAAL;AACH;;AAEDR,EAAAA,YAAY,GAAG;AACX,QAAI,KAAKH,MAAT,EAAiB;AACb,WAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnB,MAAL,CAAYiB,MAAhC,EAAwCE,CAAC,EAAzC,EAA6C;AACzC,YAAI,KAAKnB,MAAL,CAAYmB,CAAZ,EAAelD,GAAf,KAAuB,KAAKC,KAAL,CAAWC,EAAtC,EAA0C;AACtC,eAAKY,WAAL,CAAiBI,SAAjB,CAA2B6B,GAA3B,CAA+B,qCAA/B;AACH;AACJ;AACJ;AACJ,GA1IqB,CA4ItB;;;AACAvC,EAAAA,WAAW,GAAG;AACV,SAAKO,QAAL,CAAcwC,MAAd;AACH;;AA/IqB;AAgJzB","sourcesContent":["export default class Card {\r\n    constructor(cardTemplate, name, link, cardId, likes, handleImageClick, confirmPopup, owner, user) {\r\n        this._cardTemplate = cardTemplate;\r\n        this._name = name;\r\n        this._link = link;\r\n        this._cardId = cardId;\r\n        this._likes = likes;\r\n        this._handleImageClick = handleImageClick;\r\n        this._confirmPopup = confirmPopup;\r\n        this._owner = owner;\r\n        this._user = user;\r\n    }\r\n\r\n    // * * this function generates the card \r\n    generateCard(api) {\r\n        this._createCard();\r\n        this._setEventListeners(api);\r\n        this._toggleLikes();\r\n        return this._element;\r\n    }\r\n\r\n    // * * this function sets all the info of the card\r\n    _createCard() {\r\n        this._element = this._getTemplate();\r\n        const card = this._element;\r\n        this._cardImage = card.querySelector(\".card__image\");\r\n        card.querySelector(\".card__text\").textContent = this._name;\r\n        this._cardImage.src = this._link;\r\n        this._cardImage.alt = `A view of ${ this._name }`;\r\n        this._likeNumber = this._element.querySelector(\".card__like-number\");\r\n        this._likeNumber.textContent = this.getLikeNumber();\r\n        return card;\r\n    }\r\n\r\n    _setCardLikes() {\r\n        this._likeNumber.textContent = this.getLikeNumber();\r\n    }\r\n\r\n    // * * this function creates the card template\r\n    _getTemplate() {\r\n        const cardElement = document\r\n            .querySelector(this._cardTemplate)\r\n            .content\r\n            .querySelector(\".card\")\r\n            .cloneNode(true);\r\n        this._cardDelete = cardElement.querySelector(\".card__delete\");\r\n        if (this._owner) {\r\n            if (!(this._owner._id === this._user.id)) {\r\n                this._cardDelete.classList.add(\"card__delete_hidden\");\r\n            }\r\n        }\r\n        return cardElement;\r\n    }\r\n\r\n    getLikeNumber() {\r\n        if (this._likes) {\r\n            return this._likes.length;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    handleClick = (api) => {\r\n        if (this._owner._id === this._user.id) {\r\n            return api.deleteCard(this._cardId)\r\n                .then(() => {\r\n                    this._confirmPopup.close();\r\n                    this._deleteCard();\r\n                }).catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        }\r\n    }\r\n\r\n    // * * this function creates all the event listeners\r\n    _setEventListeners = (api) => {\r\n        this._likeButton = this._element.querySelector(\".card__like-button\");\r\n        this._likeButton.addEventListener(\"click\", () => {\r\n            if (!this._likeButton.classList.contains(\"info__card_like-button_state_active\")) {\r\n                this._likeJustClicked = true;\r\n            }\r\n            this._checkLikes(api);\r\n        });\r\n\r\n\r\n        this._cardDelete.addEventListener(\"click\", () => {\r\n            this._confirmPopup.open(this.handleClick, api);\r\n        });\r\n\r\n        this._cardImage.addEventListener(\"click\", () => {\r\n            this._handleImageClick({ url: this._link, caption: this._name });\r\n        });\r\n    }\r\n\r\n    _isLiked() {\r\n        for (let i = 0; i < this._likes.length; i++) {\r\n            if (this._likes[i]._id === this._user.id) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // * * this function toggles likes for the cards\r\n    _checkLikes(api) {\r\n        if (this._likeJustClicked) {\r\n            if (this._likes) {\r\n                this._likes[this._likes.length] = this._user;\r\n            }\r\n            api.addLike(this._cardId)\r\n                .then(() => {\r\n                    this._likeNumber.textContent = this.getLikeNumber();\r\n                    this._likeButton.classList.add(\"info__card_like-button_state_active\");\r\n                    this._justClicked = false;\r\n                }).catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        } else {\r\n            api.removeLike(this._cardId)\r\n                .then((data) => {\r\n                    this._likes = data.likes;\r\n                    this._likeNumber.textContent = this.getLikeNumber();\r\n                    this._likeButton.classList.remove(\"info__card_like-button_state_active\");\r\n                }).catch((err) => {\r\n                    console.log(err);\r\n                });\r\n\r\n        }\r\n        this._setCardLikes();\r\n    }\r\n\r\n    _toggleLikes() {\r\n        if (this._likes) {\r\n            for (let i = 0; i < this._likes.length; i++) {\r\n                if (this._likes[i]._id === this._user.id) {\r\n                    this._likeButton.classList.add(\"info__card_like-button_state_active\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // * * this function deletes the card\r\n    _deleteCard() {\r\n        this._element.remove();\r\n    }\r\n};"]},"metadata":{},"sourceType":"module"}